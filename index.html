<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>é…å¯¹ç”Ÿå­—æˆè¯è¯­ç»ƒä¹  </title>
<style>
  :root{
    --bg:#fff8f0; --panel:#ffffff; --accent:#ff9f43; --good:#34c759; --bad:#ff6b6b; --muted:#6b6b6b
  }
  *{box-sizing:border-box}
  body{font-family: "Microsoft YaHei", Arial, sans-serif;background:var(--bg);color:#222;margin:0;padding:24px;display:flex;flex-direction:column;align-items:center}
  h1{color:var(--accent);margin:6px 0 2px;font-size:1.6rem}
  p.lead{color:var(--muted);margin:0 0 12px}

  .controls{width:100%;max-width:980px;display:flex;gap:10px;align-items:center;margin:12px 0}
  .score{font-weight:700;color:#333}
  .spacer{flex:1}
  .btn{background:var(--panel);border:1px solid #ffdca8;padding:8px 12px;border-radius:8px;cursor:pointer}
  .btn.primary{background:linear-gradient(180deg,var(--accent),#ffb366);color:#fff;border:none}

  .exercise-wrap{width:100%;max-width:980px;background:var(--panel);border-radius:12px;padding:18px;box-shadow:0 10px 30px rgba(20,30,40,0.06)}

  /* rows layout: each row is a horizontal pair */
  .match-container{display:flex;flex-direction:column;gap:12px}
  .match-row{display:flex;align-items:center;gap:28px;justify-content:center}

  .draggable{
    width:64px;height:64px;line-height:64px;border-radius:10px;text-align:center;font-size:28px;background:#fff8e6;border:2px solid #ffd0a8;cursor:grab;user-select:none;transition:transform .18s ease,box-shadow .18s ease
  }
  .draggable.placed{opacity:0.6;cursor:default}

  .dropzone{min-width:220px;height:64px;border-radius:10px;border:2px dashed #e6e6e6;background:#f8fcff;display:flex;align-items:center;justify-content:center;padding:8px;font-size:20px}

  /* success animation */
  .pop{animation:pop .45s ease forwards}
  @keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.12)}100%{transform:scale(1)}}
  .glow{box-shadow:0 0 18px 6px rgba(255,220,120,0.55)}

  /* wrong shake */
  .shake{animation:shake .5s ease}
  @keyframes shake{0%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-6px)}80%{transform:translateX(6px)}100%{transform:translateX(0)}}

  /* full-score modal */
  .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(0.9);background:linear-gradient(180deg,#fff9f0,#fff4e6);padding:24px;border-radius:14px;box-shadow:0 30px 60px rgba(0,0,0,0.18);display:none;align-items:center;flex-direction:column;z-index:999}
  .modal.show{display:flex;animation:modalIn .45s ease forwards}
  @keyframes modalIn{0%{transform:translate(-50%,-50%) scale(0.9);opacity:0}100%{transform:translate(-50%,-50%) scale(1);opacity:1}}
  .modal h2{margin:0;color:#175e26}
  .modal p{margin:8px 0 0;color:#175e26}

  /* responsive */
  @media (max-width:720px){.match-row{gap:14px;flex-wrap:wrap}.dropzone{min-width:160px}}
</style>
</head>
<body>
  <h1>é…å¯¹ç”Ÿå­—æˆè¯è¯­ç»ƒä¹  â€” ä¼˜åŒ–ç‰ˆ</h1>
  <p class="lead">æ‹–åŠ¨å·¦ä¾§ç”Ÿå­—åˆ°å³ä¾§ç©ºæ ¼å¤„å®Œæˆè¯è¯­ã€‚æ­£ç¡®ä¼šæœ‰åŠ¨ç”»ä¸æç¤ºéŸ³ï¼Œé”™è¯¯ä¼šæ™ƒåŠ¨å¹¶å‘å‡ºæç¤ºå£°ã€‚</p>

  <div class="controls">
    <div class="score" id="score">å¾—åˆ†ï¼š0 / 10</div>
    <div class="spacer"></div>
    <button class="btn" id="prevBtn">ä¸Šä¸€é¡µ</button>
    <div id="pageInfo">ç¬¬ 1 / 2 é¡µ</div>
    <button class="btn" id="nextBtn">ä¸‹ä¸€é¡µ</button>
    <button class="btn primary" id="indepBtn">ç‹¬ç«‹ç»ƒä¹ ï¼ˆæ–°é¡µé¢ï¼‰</button>
    <button class="btn" id="backBtn" style="display:none">è¿”å›åˆ†é¡µ</button>
  </div>

  <div class="exercise-wrap">
    <div id="exerciseArea" class="match-container"></div>
    <div style="margin-top:14px;display:flex;gap:10px;justify-content:center">
      <button class="btn" id="resetBtn">é‡ç½®æœ¬é¡µ</button>
    </div>
  </div>

  <div class="modal" id="congrats">
    <h2>ğŸ‰ å¤ªæ£’äº†ï¼</h2>
    <p>ä½ å®Œæˆäº†å…¨éƒ¨é¢˜ç›®ï¼</p>
  </div>

  <!-- sounds -->
  <audio id="dingSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_977c5b3a05.mp3?filename=ding-36029.mp3"></audio>
  <audio id="wrongSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5d30f36c2e.mp3?filename=error-126627.mp3"></audio>
  <audio id="clapSound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_2fd2f0a2f1.mp3?filename=applause-8bit-6342.mp3"></audio>

<script>
// æ•°æ®å®šä¹‰ï¼ˆ20 å­—ï¼Œåˆ†ä¸¤é¡µï¼‰
const allData = [
  {char:'çˆ¸', phrase:'æˆ‘ï¼ˆã€€ï¼‰å¦ˆå¦ˆ'},
  {char:'å¦ˆ', phrase:'ï¼ˆã€€ï¼‰çˆ¸'},
  {char:'ç¬‘', phrase:'ï¼ˆã€€ï¼‰ç€'},
  {char:'ç€', phrase:'å›ï¼ˆã€€ï¼‰'},
  {char:'å›', phrase:'ï¼ˆã€€ï¼‰å“¥'},
  {char:'å“¥', phrase:'ï¼ˆã€€ï¼‰å§'},
  {char:'å“¥', phrase:'ï¼ˆã€€ï¼‰å®¶'},
  {char:'å§', phrase:'ï¼ˆã€€ï¼‰çš„'},
  {char:'å…¨', phrase:'ä¸€ï¼ˆã€€ï¼‰æ˜Ÿ'},
  {char:'å®¶', phrase:'ï¼ˆã€€ï¼‰é—´'},
  {char:'çš„', phrase:'æˆ‘ï¼ˆã€€ï¼‰å¦ˆå¦ˆ'},
  {char:'æ˜Ÿ', phrase:'ï¼ˆã€€ï¼‰æ˜Ÿ'},
  {char:'é‚£', phrase:'é‚£ï¼ˆã€€ï¼‰ä¹ˆ'},
  {char:'è¿™', phrase:'è¿™ï¼ˆã€€ï¼‰ä¹ˆ'},
  {char:'ä¹ˆ', phrase:'å¤šï¼ˆã€€ï¼‰'},
  {char:'å¤š', phrase:'å¾ˆï¼ˆã€€ï¼‰'},
  {char:'è¿™', phrase:'è¿™ï¼ˆã€€ï¼‰å„¿'},
  {char:'é¢—', phrase:'ä¸€ï¼ˆã€€ï¼‰æ˜Ÿ'},
  {char:'ä¸­', phrase:'ï¼ˆã€€ï¼‰é—´'},
  {char:'é—´', phrase:'æˆ¿ï¼ˆã€€ï¼‰'}
];

const PAGE_SIZE = 10;
let page = 0; // 0 or 1
let currentPageData = [];
let inIndependentMode = false;
let placedCount = 0;

// ç‹¬ç«‹ç»ƒä¹ é›†ï¼ˆå³ä¾§æ˜¾ç¤ºå¸¦ç©ºä½çš„çŸ­è¯­ï¼Œå­¦ç”Ÿæ‹–å…¥æ­£ç¡®å•å­—ï¼‰
const independentSet = [
  {answer:'çš„', phrase:'æˆ‘ï¼ˆã€€ï¼‰å¦ˆå¦ˆ'},
  {answer:'çˆ¸', phrase:'ï¼ˆã€€ï¼‰çˆ¸'},
  {answer:'å¦ˆ', phrase:'ï¼ˆã€€ï¼‰å¦ˆ'},
  {answer:'ç¬‘', phrase:'ï¼ˆã€€ï¼‰ç€'},
  {answer:'å®¶', phrase:'å›ï¼ˆã€€ï¼‰'},
  {answer:'å“¥', phrase:'ï¼ˆã€€ï¼‰å“¥'},
  {answer:'å§', phrase:'ï¼ˆã€€ï¼‰å§'},
  {answer:'å…¨', phrase:'ï¼ˆã€€ï¼‰å®¶'},
  {answer:'é¢—', phrase:'ä¸€ï¼ˆã€€ï¼‰æ˜Ÿ'},
  {answer:'ä¸­', phrase:'ï¼ˆã€€ï¼‰é—´'}
];

// é¢„åŠ è½½éŸ³é¢‘å…ƒç´ 
const ding = document.getElementById('dingSound');
const wrong = document.getElementById('wrongSound');
const clap = document.getElementById('clapSound');

function paginate(){
  const start = page * PAGE_SIZE;
  currentPageData = allData.slice(start, start + PAGE_SIZE);
}

function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5); }

function updateScoreDisplay(){
  const total = inIndependentMode ? independentSet.length : currentPageData.length;
  document.getElementById('score').textContent = `å¾—åˆ†ï¼š${placedCount} / ${total}`;
}

function buildRows(data){
  const area = document.getElementById('exerciseArea');
  area.innerHTML = '';
  placedCount = 0; updateScoreDisplay();

  // å·¦ chars list (shuffled) and right targets (shuffled rows), but we will align rows by pairing a shuffled left with a shuffled right
  const leftChars = shuffle(data.map(d=>d.char));
  const targets = shuffle(data.map(d=>({char:d.char, phrase:d.phrase})));

  // To create a neat row alignment, iterate index-wise; if counts equal (they are), pair by index for layout but matching logic uses dataset.answer on dropzone
  for(let i=0;i<targets.length;i++){
    const row = document.createElement('div'); row.className = 'match-row';

    // left draggable (take one from leftChars)
    const ch = leftChars[i];
    const drag = document.createElement('div'); drag.className='draggable'; drag.textContent = ch; drag.draggable = true;
    drag.id = `drag-${i}-${Date.now()}-${Math.random().toString(36).slice(2,6)}`;
    drag.addEventListener('dragstart', e=>{ e.dataTransfer.setData('text/plain', drag.id); });
    drag.addEventListener('click', ()=>speak(ch));

    // right dropzone uses targets[i]
    const tgt = targets[i];
    const drop = document.createElement('div'); drop.className='dropzone';
    drop.dataset.answer = tgt.char; // expected character
    drop.dataset.phrase = tgt.phrase;
    drop.innerHTML = tgt.phrase; // shows the phrase with empty bracket

    // dragover
    drop.addEventListener('dragover', e=>{ e.preventDefault(); });

    // drop handling
    drop.addEventListener('drop', e=>{
      e.preventDefault();
      const draggedId = e.dataTransfer.getData('text/plain');
      const draggedEl = document.getElementById(draggedId);
      if(!draggedEl) return;
      const draggedChar = draggedEl.textContent;

      // if already filled, move previous back
      const existing = drop.querySelector('.draggable');
      if(existing){
        // return existing to left area (append to top of exercise area left column by inserting before row)
        existing.classList.remove('placed'); existing.draggable = true;
        // find a place to put it back: prepend to exercise area
        document.getElementById('exerciseArea').insertBefore(existing, document.getElementById('exerciseArea').firstChild);
      }

      // check correctness
      if(draggedChar === drop.dataset.answer){
        // correct
        drop.innerHTML = drop.dataset.phrase.replace('ï¼ˆã€€ï¼‰', `<strong>${draggedChar}</strong>`);
        draggedEl.classList.add('placed'); draggedEl.draggable = false;
        // visual effects
        draggedEl.classList.add('pop'); drop.classList.add('glow');
        setTimeout(()=>{ draggedEl.classList.remove('pop'); drop.classList.remove('glow'); }, 700);
        try{ ding.currentTime = 0; ding.play(); }catch(e){}
        placedCount++;
        updateScoreDisplay();

        // if full, celebrate
        const total = inIndependentMode ? independentSet.length : currentPageData.length;
        if(placedCount === total){ showCongrats(); }
      } else {
        // wrong: attach then shake and remove
        // temporarily show the wrong char in the drop area for feedback
        drop.classList.add('shake');
        try{ wrong.currentTime = 0; wrong.play(); }catch(e){}
        setTimeout(()=> drop.classList.remove('shake'),500);
      }

    });

    row.appendChild(drag);
    row.appendChild(drop);
    area.appendChild(row);
  }
}

function renderPage(){
  inIndependentMode = false;
  paginate();
  document.getElementById('pageInfo').textContent = `ç¬¬ ${page+1} / ${Math.ceil(allData.length / PAGE_SIZE)} é¡µ`;
  buildRows(currentPageData);
}

function renderIndependent(){
  inIndependentMode = true;
  document.getElementById('pageInfo').textContent = 'ç‹¬ç«‹ç»ƒä¹ ';
  buildRows(independentSet.map(d=>({char:d.answer, phrase:d.phrase}))); // build rows from independentSet
}

function showCongrats(){
  const modal = document.getElementById('congrats');
  modal.classList.add('show');
  try{ clap.currentTime = 0; clap.play(); }catch(e){}
  setTimeout(()=>{ modal.classList.remove('show'); }, 2500);
}

// controls
document.getElementById('nextBtn').addEventListener('click', ()=>{ if((page+1)*PAGE_SIZE < allData.length){ page++; paginate(); renderPage(); } });
document.getElementById('prevBtn').addEventListener('click', ()=>{ if(page>0){ page--; renderPage(); } });

// independent mode toggle
document.getElementById('indepBtn').addEventListener('click', ()=>{
  // hide paging buttons, show back
  document.getElementById('prevBtn').style.display = 'none';
  document.getElementById('nextBtn').style.display = 'none';
  document.getElementById('indepBtn').style.display = 'none';
  document.getElementById('backBtn').style.display = 'inline-block';
  placedCount = 0; updateScoreDisplay();
  renderIndependent();
});

document.getElementById('backBtn').addEventListener('click', ()=>{
  document.getElementById('prevBtn').style.display = 'inline-block';
  document.getElementById('nextBtn').style.display = 'inline-block';
  document.getElementById('indepBtn').style.display = 'inline-block';
  document.getElementById('backBtn').style.display = 'none';
  page = 0; renderPage();
});

// reset page
document.getElementById('resetBtn').addEventListener('click', ()=>{
  placedCount = 0; updateScoreDisplay();
  if(inIndependentMode) renderIndependent(); else renderPage();
});

// speak function
function speak(text){ try{ const u = new SpeechSynthesisUtterance(text); u.lang='zh-CN'; window.speechSynthesis.speak(u);}catch(e){}
}

// init
paginate(); renderPage(); updateScoreDisplay();
</script>
</body>
</html>